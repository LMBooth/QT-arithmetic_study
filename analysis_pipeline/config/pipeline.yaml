version: 1

paths:
  bids_root: "./bids_arithmetic"
  python_executable: "python"

reports:
  run_manifest: "analysis_pipeline/reports/run_manifest.json"

stages:
  stage0: false
  stage1: false
  stage2: false
  stage3: false
  stage4: false
  stage5: false
  stage6: true
  stage6_confusions: true

stage_args:
  stage0:
    strict: false
  stage1:
    strict: false
  stage2:
    overwrite: true
  stage3:
    window_mode: "calc_fixed"
    overwrite: true
  stage4: {}
  stage5:
    dropout_policy: "absolute"
    dropout_threshold: 35.0

stage6:
  run_tag_prefix: "stage7"
  results_json_template: "analysis_pipeline/reports/ml_results_{scenario}.json"
  summary_md_template: "analysis_pipeline/reports/ml_summary_{scenario}.md"
  base_args:
    datasets: ["eeg", "ecg", "pupil", "fused"]
    protocols: ["loso", "group_holdout", "within_participant"]
    models: ["logreg", "svm", "knn", "mlp", "rf"]
    inner_folds: 3
    max_param_combos: 3
    max_outer_splits_per_protocol: 2
    clip_lower_quantile: 0.01
    clip_upper_quantile: 0.99
    random_seed: 42
  class_scenarios:
    - name: "all_bins"
    - name: "omit_easiest"
      drop_labels: ["0.6-1.5"]
    - name: "three_level_merged"
      merge_map:
        "0.6-1.5": "low"
        "1.5-2.4": "low"
        "2.4-3.3": "mid"
        "3.3-4.2": "mid"
        "4.2-5.1": "high"
        "5.1-6.0": "high"
        "6.0-6.9": "high"

stage6_confusions:
  out_json_template: "analysis_pipeline/reports/confusion_highlights_{scenario}.json"
  out_md_template: "analysis_pipeline/reports/confusion_highlights_{scenario}.md"
  args:
    metric: "balanced_accuracy_mean"
    top_k_per_protocol: 1

